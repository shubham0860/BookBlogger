<input id="btnGrid" class="btn btn-success"
       type="button" value="All Books" />

<input id="btnAdd" class="btn btn-success"
       type="button" value="My Books" />

<input id="btnAudit" class="btn btn-success"
       type="button" value="Audit Data" />

<div id="grid"></div>
<div id="Add"></div>
<div id="audit"></div>
<script>
    $(document).ready(function () {
        $("#btnGrid").click(function () {
            $("#Add").hide();
            $('#audit').hide();
            $("#grid").toggle();

        });
        $("#btnAdd").click(function () {
            $("#grid").hide();
            $("#audit").hide();
            $("#Add").toggle();
        });
        $("#btnAudit").click(function () {
            $("#grid").hide();
            $("#Add").hid();
            $("#audit").toggle();
        });
    });
    $("#grid").kendoGrid({
        height: 500,
        toolbar: ["create"],
        
        columns: [
            { field: "ISBN" },
            { field: "BookName" },
            { field: "Price" },
            { field: "Details" },
            { field: "ImageUrl" },
            { field: "DownloadUrl" },
            { field: "AuthorName" },
            { field: "Surname" },
            //{ field: "CreatedDateTime" },
            //{ field: "UpdatedDateTime" },
            
            { command: ["edit", "destroy"], width: 180 }

        ],

        dataSource: {
            type: "webapi",
            transport: {
                idField: "ID",
                read: {
                    url: "/api/Books"
                },
                create: {
                    url: "api/Books"
                },
                update: {
                    url: "/api/Books/{0}"
                },
                destroy: {
                    type: "delete",
                    //Response: "response",

                    url: "api/Books/{0}"
                }

            },
            schema: {
                data: "Data",
                total: "Total",
                errors: "Errors",
                
                model: {
                    id: "ID",
                    fields: {
                        ID: { type: "number" },
                        ISBN: { type: "string" },
                        BookName: { type: "string" },
                        Price: { type: "number" },
                        Details: { type: "string" },
                        ImageUrl: { type: "string" },
                        DownloadUrl: { type: "string" },
                        AuthorName: { type: "string" },
                        Surname: { type: "string" }


                    }
                    
                }
                
              
            },
            serverPaging: true,
            serverSorting: true,
            serverFiltering: true,
            serverGrouping: true,
            /*dataBound: onDataBound,*/
            serverAggregates: true,
        },
        //error: function (e) {
        //    var json = jQuery.parseJSON(e.responseText);
        //    alert("An error has occured: " + json.Message);
        //},
        editable: "inline",
        destroy: true,
        pageable: true,
        scrollable: true
    })
    //function onDataBound(e) {
    //    //Implement the event handler for dataBound
    //    var img = model.ImageUrl;
    //    columnMenu.ImageUrl = '<img src={img} />';
    //}

    $("#Add").kendoGrid({
        height: 500,
        /*toolbar: ["create"],*/
        columns: [
            { field: "ISBN" },
            { field: "BookName" },
            { field: "Price" },
            { field: "Details" },
            { field: "ImageUrl" },
            { field: "DownloadUrl" },
            { field: "AuthorName" },
            { field: "Surname" }
        ],

        dataSource: {
            type: "webapi",
            transport: {
                idField: "ID",
                read: {
                    url: "/api/Books/UserBooks"
                }
            },
            schema: {
                data: "Data",
                total: "Total",
                errors: "Errors",
                model: {
                    id: "ID",
                    fields: {
                        ID: { type: "number" },
                        ISBN: { type: "string" },
                        BookName: { type: "string" },
                        Price: { type: "number" },
                        Details: { type: "string" },
                        ImageUrl: { type: "string" },
                        DownloadUrl: { type: "string" },
                        AuthorName: { type: "string" },
                        Surname: { type: "string" }
                    }
                }
            },
            serverPaging: true,
            serverSorting: true,
            serverFiltering: true,
            serverGrouping: true,
            serverAggregates: true,
        },
        editable: "inline",
        destroy: true,
        pageable: true,
        scrollable: true
    })

    $("#audit").kendoGrid({
        height: 400,
        columns: [
            { field: "UserID" },
            { field: "BookID" },
            { field: "Operation" },
            { field: "NewValue" },
            { field: "OldValue" },
            { field: "CreatedDateTime" }
        ],
        dataSource: {
            type: "webapi",
            transport: {
                idField: "ID",
                read: {
                    url: "/api/Books/GetAudit"
                }
            },
            schema: {
                data: "Data",
                total: "Total",
                errors: "Errors",
                model: {
                    id: "ID",
                    fields: {
                        ID: { type: "number" },
                        UserID: { type: "number" },
                        BookID: { type: "number" },
                        Operation: { type: "string" },
                        NewValue: { type: "string" },
                        OldValue: { type: "string" },
                        CreatedDateTime: { type: "date" }
                    }
                }
            },
            serverPaging: true,
            serverSorting: true,
            serverFiltering: true,
            serverGrouping: true,
            serverAggregates: true,
        },
        pageable: true,
        navigatable: true
    })
</script>
